function formatNumber(num) {


  if (num >= 1e201) {
    return (num / 1e201).toFixed(2) + "Millinillion";
  }
  if (num >= 1e198) {
    return (num / 1e198).toFixed(2) + "Nongentillion";
  }
  if (num >= 1e195) {
    return (num / 1e195).toFixed(2) + "Octingentillion";
  }
  if (num >= 1e192) {
    return (num / 1e192).toFixed(2) + "Septingentillion";
  }
  if (num >= 1e189) {
    return (num / 1e189).toFixed(2) + "Sescentillion";
  }
  if (num >= 1e186) {
    return (num / 1e186).toFixed(2) + "Quingentillion";
  }
  if (num >= 1e183) {
    return (num / 1e183).toFixed(2) + "Quadringentillion";
  }
  if (num >= 1e180) {
    return (num / 1e180).toFixed(2) + "Trecentillion";
  }
  if (num >= 1e177) {
    return (num / 1e177).toFixed(2) + "Ducentillion";
  }
  if (num >= 1e174) {
    return (num / 1e174).toFixed(2) + "Nonagintacentillion";
  }
  if (num >= 1e171) {
    return (num / 1e171).toFixed(2) + "Octogintacentillion";
  }
  if (num >= 1e168) {
    return (num / 1e168).toFixed(2) + "Septuagintacentillion";
  }
  if (num >= 1e165) {
    return (num / 1e165).toFixed(2) + "Sexagintacentillion";
  }
  if (num >= 1e162) {
    return (num / 1e162).toFixed(2) + "QuinquaÂ­gintacentillion";
  }
  if (num >= 1e159) {
    return (num / 1e159).toFixed(2) + "Quadragintacentillion";
  }
  if (num >= 1e156) {
    return (num / 1e156).toFixed(2) + "Trigintacentillion";
  }
  if (num >= 1e153) {
    return (num / 1e153).toFixed(2) + "Unviginticentillion";
  }
  if (num >= 1e150) {
    return (num / 1e150).toFixed(2) + "Viginticentillion";
  }
  if (num >= 1e147) {
    return (num / 1e147).toFixed(2) + "Undecicentillion";
  }
  if (num >= 1e144) {
    return (num / 1e144).toFixed(2) + "Decicentillion";
  }
  if (num >= 1e141) {
    return (num / 1e141).toFixed(2) + "Uncentillion";
  }
  if (num >= 1e138) {
    return (num / 1e138).toFixed(2) + "Centillion";
  }
  if (num >= 1e135) {
    return (num / 1e135).toFixed(2) + "Nonagintillion";
  }
  if (num >= 1e132) {
    return (num / 1e132).toFixed(2) + "Octogintillion";
  }
  if (num >= 1e129) {
    return (num / 1e129).toFixed(2) + "Septuagintillion";
  }
  if (num >= 1e126) {
    return (num / 1e126).toFixed(2) + "Sexagintillion";
  }
  if (num >= 1e123) {
    return (num / 1e123).toFixed(2) + "Quinquagintillion";
  }
  if (num >= 1e120) {
    return (num / 1e120).toFixed(2) + "Quadragintillion";
  }
  if (num >= 1e117) {
    return (num / 1e117).toFixed(2) + "Noventrigintillion";
  }
  if (num >= 1e114) {
    return (num / 1e114).toFixed(2) + "Octotrigintillion";
  }
  if (num >= 1e111) {
    return (num / 1e111).toFixed(2) + "Septentrigintillion";
  }
  if (num >= 1e108) {
    return (num / 1e108).toFixed(2) + "Sestrigintillion";
  }
  if (num >= 1e105) {
    return (num / 1e105).toFixed(2) + "Quintrigintillion";
  }
  if (num >= 1e102) {
    return (num / 1e102).toFixed(2) + "Quattuortrigintillion";
  }
  if (num >= 1e99) {
    return (num / 1e99).toFixed(2) + "Trestrigintillion";
  }
  if (num >= 1e96) {
    return (num / 1e96).toFixed(2) + "Duotrigintillion";
  }
  if (num >= 1e93) {
    return (num / 1e93).toFixed(2) + "Untrigintillion";
  }










  if (num >= 1e93) {
    return (num / 1e93).toFixed(2) + "Tg";
  }
  if (num >= 1e90) {
    return (num / 1e90).toFixed(2) + "Nvg";
  }
  if (num >= 1e87) {
    return (num / 1e87).toFixed(2) + "Ovg";
  }
  if (num >= 1e84) {
    return (num / 1e84).toFixed(2) + "Spv";
  }
  if (num >= 1e81) {
    return (num / 1e81).toFixed(2) + "Svg";
  }
  if (num >= 1e78) {
    return (num / 1e78).toFixed(2) + "Qvg";
  }
  if (num >= 1e75) {
    return (num / 1e75).toFixed(2) + "Qav";
  }
  if (num >= 1e72) {
    return (num / 1e72).toFixed(2) + "Tvg";
  }
  if (num >= 1e69) {
    return (num / 1e69).toFixed(2) + "D";
  }
  if (num >= 1e66) {
    return (num / 1e66).toFixed(2) + "C";
  }
  if (num >= 1e63) {
    return (num / 1e63).toFixed(2) + "V";
  }
  if (num >= 1e60) {
    return (num / 1e60).toFixed(2) + "N";
  }
  if (num >= 1e57) {
    return (num / 1e57).toFixed(2) + "O";
  }
  if (num >= 1e54) {
    return (num / 1e54).toFixed(2) + "St";
  }
  if (num >= 1e51) {
    return (num / 1e51).toFixed(2) + "Sd";
  }
  if (num >= 1e48) {
    return (num / 1e48).toFixed(2) + "Qd";
  }
  if (num >= 1e45) {
    return (num / 1e45).toFixed(2) + "Qt";
  }
  if (num >= 1e42) {
    return (num / 1e42).toFixed(2) + "Tdc";
  }
  if (num >= 1e39) {
    return (num / 1e39).toFixed(2) + "Ddc";
  }
  if (num >= 1e36) {
    return (num / 1e36).toFixed(2) + "Udc";
  }
  if (num >= 1e33) {
    return (num / 1e33).toFixed(2) + "Dc";
  }
  if (num >= 1e30) {
    return (num / 1e30).toFixed(2) + "No";
  }
  if (num >= 1e27) {
    return (num / 1e27).toFixed(2) + "Oc";
  }
  if (num >= 1e24) {
    return (num / 1e24).toFixed(2) + "Sp";
  }
  if (num >= 1e21) {
    return (num / 1e21).toFixed(2) + "Sx";
  }
  if (num >= 1e18) {
    return (num / 1e18).toFixed(2) + "Qi";
  }
  if (num >= 1e15) {
    return (num / 1e15).toFixed(2) + "Qa";
  }
  if (num >= 1e12) {
    return (num / 1e12).toFixed(2) + "T";
  }
  if (num >= 1e9) {
    return (num / 1e9).toFixed(2) + "B";
  }
  if (num >= 1e6) {
    return (num / 1e6).toFixed(2) + "M";
  }
  if (num >= 1e3) {
    return (num / 1e3).toFixed(2) + "K";
  }
  return num.toString();
}









//document.addEventListener('contextmenu', event => event.preventDefault()); disabilita il tasto destro del mouse


//definisco ham
document.addEventListener('DOMContentLoaded', function () {


  var _ham; // Variabile privata per memorizzare il valore di ham

  Object.defineProperty(window, 'ham', {
    get: function () {
      return _ham;
    },
    set: function (value) {
      _ham = value;
      onChangeHam();
    }
  });
    
  
  for (var i = 1; i <= 12; i++) {
    $("#upgradeButton" + i).css("background-color", "red");
    $("#upgradeButton" + i).prop("disabled", true);
  }

  ham = 0;
});



var clickMultiplier = 1;

var hamPerSecond = 0;



var upg1Level = 0;
var upg1Price = 15;

var upg2Level = 0;
var upg2Price = 150;

var upg3Level = 0;
var upg3Price = 1500;

var upg4Level = 0;
var upg4Price = 10000;

var upg5Level = 0;
var upg5Price = 120000;

var upg6Level = 0;
var upg6Price = 2500000;

var upg7Level = 0;
var upg7Price = 30000000;

var upg8Level = 0;
var upg8Price = 500000000;

var upg9Level = 0;
var upg9Price = 5000000000;

var upg10Level = 0;
var upg10Price = 40000000000;

var upg11Level = 0;
var upg11Price = 350000000000;

var upg12Level = 0;
var upg12Price = 5000000000000;



var hamProduceUpg1 = 1;
var hamProduceUpg2 = 1;
var hamProduceUpg3 = 10;
var hamProduceUpg4 = 50;
var hamProduceUpg5 = 500;
var hamProduceUpg6 = 10000;
var hamProduceUpg7 = 100000;
var hamProduceUpg8 = 2000000;
var hamProduceUpg9 = 15000000;
var hamProduceUpg10 = 150000000;
var hamProduceUpg11 = 2000000000;
var hamProduceUpg12 = 50000000000;



var boolFirstPopupLevel = true;
var boolSecondPopupLevel = true;



function clickPig() {
  ham += clickMultiplier;
  updateHamCounter();

  var explosion = $("<div>").addClass("explosion")
    .css({
      left: event.clientX - 40 + "px",
      top: event.clientY - 40 + "px"
    });

  var hamImg = $("<img>").attr("src", "ham.png")
    .addClass("ham-img");
  explosion.append(hamImg);

  var hamCounter = $("<span>").addClass("ham-counter")
    .text("+" + clickMultiplier);
  explosion.append(hamCounter);

  $("body").append(explosion);

  setTimeout(function () {
    explosion.remove();
  }, 520); // Aumentato il tempo di visualizzazione a 1 secondo
}

function updateHamCounter() {

  $("#hamCounter").html(formatNumber(ham) + " hams");
}



function updateClickMultiplier() {
  $("#clickPowerDisplay").html("Click power: " + formatNumber(clickMultiplier));
}

function updateHamPerSecond() {
  $("#hamPerSecondDisplay").html("Hams per second: " + formatNumber(hamPerSecond));
}

function updateLvl(id, livelloAttuale) {
  $("#" + id).html("Lvl " + formatNumber(livelloAttuale));
}


function getUser() {
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "home.php?action=getUser", true); // Aggiorna l'azione per richiedere tutti gli utenti
  xhr.onreadystatechange = function () {
    if (xhr.readyState == 4 && xhr.status == 200) {
      var ids = xhr.responseText;

      var idArray = ids.split(',');
      console.log("Numero di ID:", idArray.length);
      for (var i = 0; i < idArray.length; i++) {
        console.log("ID:", idArray[i]);
      }
    }
  };
  xhr.send();
}



function fetchOtherDataFromDatabase() {
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "home.php?action=getOtherData", true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState == 4 && xhr.status == 200) {
      var otherData = xhr.responseText;
      console.log("Altri dati dal database:", otherData);
      // Ora puoi fare qualsiasi cosa con gli altri dati
    }
  };
  xhr.send();
}





function upgrade1() {
  if (ham >= upg1Price) {

    upg1Level++;

    updateLvl("upg1Lvl", upg1Level);

    ham -= upg1Price;

    updateHamCounter();

    clickMultiplier += hamProduceUpg1;

    checkLevelTier("level1", upg1Level);

    updateClickMultiplier();

    upg1Price = Math.round(upg1Price * 1.2);

    $("#upgradeButton1").html(formatNumber(upg1Price));
  }

}

function upgrade2() {
  if (ham >= upg2Price) {

    upg2Level++;

    updateLvl("upg2Lvl", upg2Level);

    ham -= upg2Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg2;

    checkLevelTier("level2", upg2Level);

    updateHamPerSecond();

    upg2Price = Math.round(upg2Price * 1.2);

    $("#upgradeButton2").html(formatNumber(upg2Price));
  }
}

function upgrade3() {
  if (ham >= upg3Price) {

    upg3Level++;

    updateLvl("upg3Lvl", upg3Level);

    ham -= upg3Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg3;

    checkLevelTier("level3", upg3Level);

    updateHamPerSecond();

    upg3Price = Math.round(upg3Price * 1.2);

    $("#upgradeButton3").html(formatNumber(upg3Price));
  }
}

function upgrade4() {
  if (ham >= upg4Price) {

    upg4Level++;

    updateLvl("upg4Lvl", upg4Level);

    ham -= upg4Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg4;

    checkLevelTier("level4", upg4Level);

    updateHamPerSecond();

    upg4Price = Math.round(upg4Price * 1.2);

    $("#upgradeButton4").html(formatNumber(upg4Price));
  }
}

function upgrade5() {
  if (ham >= upg5Price) {

    upg5Level++;

    updateLvl("upg5Lvl", upg5Level);

    ham -= upg5Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg5;

    checkLevelTier("level5", upg5Level);

    updateHamPerSecond();

    upg5Price = Math.round(upg5Price * 1.2);

    $("#upgradeButton5").html(formatNumber(upg5Price));
  }
}

function upgrade6() {
  if (ham >= upg6Price) {

    upg6Level++;

    updateLvl("upg6Lvl", upg6Level);

    ham -= upg6Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg6;

    checkLevelTier("level6", upg6Level);

    updateHamPerSecond();

    upg6Price = Math.round(upg6Price * 1.2);

    $("#upgradeButton6").html(formatNumber(upg6Price));
  }
}

function upgrade7() {
  if (ham >= upg7Price) {

    upg7Level++;

    updateLvl("upg7Lvl", upg7Level);

    ham -= upg7Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg7;

    checkLevelTier("level7", upg7Level);

    updateHamPerSecond();

    upg7Price = Math.round(upg7Price * 1.2);

    $("#upgradeButton7").html(formatNumber(upg7Price));
  }
}

function upgrade8() {
  if (ham >= upg8Price) {

    upg8Level++;

    updateLvl("upg8Lvl", upg8Level);

    ham -= upg8Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg8;

    checkLevelTier("level8", upg8Level);

    updateHamPerSecond();

    upg8Price = Math.round(upg8Price * 1.2);

    $("#upgradeButton8").html(formatNumber(upg8Price));
  }
}

function upgrade9() {
  if (ham >= upg9Price) {

    upg9Level++;

    updateLvl("upg9Lvl", upg9Level);

    ham -= upg9Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg9;

    checkLevelTier("level9", upg9Level);

    updateHamPerSecond();

    upg9Price = Math.round(upg9Price * 1.2);

    $("#upgradeButton9").html(formatNumber(upg9Price));
  }
}

function upgrade10() {
  if (ham >= upg10Price) {

    upg10Level++;

    updateLvl("upg10Lvl", upg10Level);

    ham -= upg10Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg10;

    checkLevelTier("level10", upg10Level);

    updateHamPerSecond();

    upg10Price = Math.round(upg10Price * 1.2);

    $("#upgradeButton10").html(formatNumber(upg10Price));
  }
}

function upgrade11() {
  if (ham >= upg11Price) {

    upg11Level++;

    updateLvl("upg11Lvl", upg11Level);

    ham -= upg11Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg11;

    checkLevelTier("level11", upg11Level);

    updateHamPerSecond();

    upg11Price = Math.round(upg11Price * 1.2);

    $("#upgradeButton11").html(formatNumber(upg11Price));
  }
}

function upgrade12() {
  if (ham >= upg12Price) {

    upg12Level++;

    updateLvl("upg12Lvl", upg12Level);

    ham -= upg12Price;

    updateHamCounter();

    hamPerSecond += hamProduceUpg12;

    checkLevelTier("level12", upg12Level);

    updateHamPerSecond();

    upg12Price = Math.round(upg12Price * 1.2);

    $("#upgradeButton12").html(formatNumber(upg12Price));
  }
}











function onChangeHam() {

  var upgrades = [
    { buttonId: "upgradeButton1", price: upg1Price },
    { buttonId: "upgradeButton2", price: upg2Price },
    { buttonId: "upgradeButton3", price: upg3Price },
    { buttonId: "upgradeButton4", price: upg4Price },
    { buttonId: "upgradeButton5", price: upg5Price },
    { buttonId: "upgradeButton6", price: upg6Price },
    { buttonId: "upgradeButton7", price: upg7Price },
    { buttonId: "upgradeButton8", price: upg8Price },
    { buttonId: "upgradeButton9", price: upg9Price },
    { buttonId: "upgradeButton10", price: upg10Price },
    { buttonId: "upgradeButton11", price: upg11Price },
    { buttonId: "upgradeButton12", price: upg12Price }
  ];


  upgrades.forEach(function (upgrade) {
    var button = $("#" + upgrade.buttonId);
    var isEnabled = upgrade.price <= ham;


    button.css("background-color", isEnabled ? "green" : "red").prop("disabled", !isEnabled);
  });
}


function checkLevelTier(nameUpgrade, levelUpgrade) {


  if (levelUpgrade == 10 || levelUpgrade % 50 == 0) {

    if (nameUpgrade == "level1") {
      hamProduceUpg1 += 1;
      $("#hamProduceUpg1").html("+" + formatNumber(hamProduceUpg1) + " ham per click");
    }
    if (nameUpgrade == "level2") {
      hamProduceUpg2 += 1;
      $("#hamProduceUpg2").html("+" + formatNumber(hamProduceUpg2) + " ham per click");
    }
    if (nameUpgrade == "level3") {
      hamProduceUpg3 += 10;
      $("#hamProduceUpg3").html("+" + formatNumber(hamProduceUpg3) + " ham per click");
    }
    if (nameUpgrade == "level4") {
      hamProduceUpg4 += 50;
      $("#hamProduceUpg4").html("+" + formatNumber(hamProduceUpg4) + " ham per click");
    }
    if (nameUpgrade == "level5") {
      hamProduceUpg5 += 500;
      $("#hamProduceUpg5").html("+" + formatNumber(hamProduceUpg5) + " ham per click");
    }
    if (nameUpgrade == "level6") {
      hamProduceUpg6 += 10000;
      $("#hamProduceUpg6").html("+" + formatNumber(hamProduceUpg6) + " ham per click");
    }
    if (nameUpgrade == "level7") {
      hamProduceUpg7 += 100000;
      $("#hamProduceUpg7").html("+" + formatNumber(hamProduceUpg7) + " ham per click");
    }
    if (nameUpgrade == "level8") {
      hamProduceUpg8 += 2000000;
      $("#hamProduceUpg8").html("+" + formatNumber(hamProduceUpg8) + " ham per click");
    }
    if (nameUpgrade == "level9") {
      hamProduceUpg9 += 15000000;
      $("#hamProduceUpg9").html("+" + formatNumber(hamProduceUpg9) + " ham per click");
    }
    if (nameUpgrade == "level10") {
      hamProduceUpg10 += 150000000;
      $("#hamProduceUpg10").html("+" + formatNumber(hamProduceUpg10) + " ham per click");
    }
    if (nameUpgrade == "level11") {
      hamProduceUpg11 += 2000000000;
      $("#hamProduceUpg11").html("+" + formatNumber(hamProduceUpg11) + " ham per click");
    }
    if (nameUpgrade == "level12") {
      hamProduceUpg12 += 50000000000;
      $("#hamProduceUpg12").html("+" + formatNumber(hamProduceUpg12) + " ham per click");
    }

  }

  if (boolSecondPopupLevel) {
    if (boolSecondPopupLevel == 50) {
      boolPopupLevel = false;
      showPopupLevel("second");
    } else if (levelUpgrade == 10 && boolFirstPopupLevel) {
      boolFirstPopupLevel = false;
      showPopupLevel("first");
    }
  }
  
}




function showPopupLevel(firSec) {
  if (firSec == "first") {
    $("#levelPopup").html("The upgrade has advanced to a higher tier, the next one is at level 50");
  }else{
    $("#levelPopup").html("The upgrade has advanced to a higher tier, now the next tiers will be every 50 levels");
  }
  var popup = document.getElementById('levelPopup');
  popup.classList.add('popupVisible');
  setTimeout(function () {
    popup.classList.remove('popupVisible');
  }, 5000);
}





function increseHamPerSecond() {

  ham += hamPerSecond;

  updateHamCounter();
}
setInterval(increseHamPerSecond, 1000);
